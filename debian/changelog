approx (3.1.0~rc1) experimental; urgency=low

  * Added support for IPv6 and TCP wrappers
    - added build-dependency on libwrap0-dev
    - closes: #468058
  * Fixed mishandling of HTTP redirections
    - handle redirection status codes and location headers in approx.ml,
      following patch supplied by Håkon Stordahl <haastord@online.no>
    - remove curl --location option from Url.download but not Url.download_file
    - closes: #469580
  * Added transparent proxying for requests that should be passed through
    without caching (closes: #469616)
  * Perform server initializations like binding to port and dropping privileges
    before daemonizing, so that any failures will be noticed by the init script
    (closes: #465450)
  * Changed Patch module to use a single composite operator
    instead of a list, so Patch.apply is just function application
  * Updated Standards-Version, DM-Upload-Allowed and VCS-* in debian/control
  * Changed from ocamlmakefile to ocamlbuild
    - removed ocamlmakefile from Build-Depends
    - added _tags files and myocamlbuild.ml plugin
    - new, simpler Makefile
    - updated debian/rules to deal with .native and .byte targets
  * Improved documentation of the garbage collection algorithm in gc.ml
  * Changed debug_message and info_message to check corresponding
    config parameters ($debug, $verbose) so callers don't have to
  * Renamed config -> config_file and default_config -> config
  * Style changes (mostly whitespace-only)
    - use only spaces in indentation, no tabs
    - write lists like this: [1; 2; 3]
    - avoid single begin/end lines

 -- Eric Cooper <ecc@cmu.edu>  Thu, 13 Mar 2008 10:05:56 -0400

approx (3.0.0) unstable; urgency=low

  * Support pdiffs (closes: #405535)
  * Create temp files in approx cache rather than TMPDIR (closes: #451768)
  * Added $offline parameter to control delivery of cached files
    when remote downloads fail (closes: #442801)

 -- Eric Cooper <ecc@cmu.edu>  Tue, 04 Dec 2007 12:24:16 -0500

approx (2.9.1) unstable; urgency=low

  * Make sure cron job doesn't fail if approx has been removed
    (closes: #404819)
  * Add Homepage field

 -- Eric Cooper <ecc@cmu.edu>  Wed, 03 Oct 2007 11:31:56 -0400

approx (2.9.0) unstable; urgency=low

  [ Eric Cooper ]
  * Changed debian/rules to use cdbs
  * Improve postinst check for conflict with apt-proxy
    (closes: #395375)
  * Make sure cron job doesn't fail if cache directory is empty
    (closes: #416361)
  * Require configuration parameters to begin with '$' to distinguish
    them from repository names
  * Added $verbose parameter to control logging of informational messages
    (closes: #403514)
  * Added $syslog parameter to specify the syslog facility
    (closes: #406504)
  * Added $user and $group parameters to control the approx daemon's user
    and group [Alexandra N. Kossovsky <sasha@oktetlabs.ru>]
    (closes: #423836)
  * Don't assume deluser is still available in postrm (closes: #416643)
  * Migrated to Ocamlnet 2 (closes: #420478)
  * Changed dependency from ocaml-tools to ocamlmakefile (closes: #428723)

  [ Ralf Treinen ]
  * Added myself to uploaders.
  * Build-depend on ocaml >= 3.10 in order to force the ocaml version on
    autobuilders.

 -- Ralf Treinen <treinen@debian.org>  Wed, 05 Sep 2007 16:43:00 +0200

approx (2.8.0) unstable; urgency=low

  * Make sure syslog messages are newline-terminated for syslog-ng
    (closes: #394925)
  * Handle tabs as well as spaces in control files (closes: #394062)
  * Added "max_rate" configuration variable (closes: #392802)
  * Improved description in approx man page of how repository mapping works
  * Added XS-Vcs-Svn header to debian/control file

 -- Eric Cooper <ecc@cmu.edu>  Mon, 23 Oct 2006 22:15:34 -0400

approx (2.7.0) unstable; urgency=low

  * New version numbering with third component for packaging-only changes
  * Deny DiffIndex requests, forcing download of full index files
    (closes: #367475)
  * Keep live source packages (those listed in Sources files)
    (closes: #374736)
  * Decode request URLs to handle '~' in pathnames (closes: #390121)
  * Validate packages with SHA256, otherwise SHA1, otherwise MD5
  * Added --fail option to curl to handle errors better
  * Made init script LSB-compliant and added dependency on lsb-base

 -- Eric Cooper <ecc@cmu.edu>  Mon, 11 Sep 2006 13:09:11 -0400

approx (2.06) unstable; urgency=low

  * Added "interface" configuration variable to allow listening only
    on a specific network interface, as requested by Romain Lenglet
    <rlenglet@users.forge.objectweb.org> (closes: #352025)
  * Added simple-minded support for file URIs, using the same logic as FTP
  * The server is now started as root by the init script, and then drops
    privileges to user approx after binding its socket. This allows approx
    to listen on port 80, as requested by Andreas John <aj@net-lab.net>

 -- Eric Cooper <ecc@cmu.edu>  Mon, 24 Apr 2006 16:09:22 -0400

approx (2.05) unstable; urgency=low

  * Factor out all uses of curl command (missed one in previous fix)
  * Transition to OCaml 3.09.1

 -- Eric Cooper <ecc@cmu.edu>  Sun,  8 Jan 2006 14:29:20 -0500

approx (2.04) unstable; urgency=low

  * Added --location option to curl so that it will follow HTTP redirections
    (closes: #346082)

 -- Eric Cooper <ecc@cmu.edu>  Thu,  5 Jan 2006 13:56:03 -0500

approx (2.03) unstable; urgency=low

  * Fixed cron script (closes: #343105)
  * Updated debian/compat to 5

 -- Eric Cooper <ecc@cmu.edu>  Mon, 12 Dec 2005 15:43:46 -0500

approx (2.02) unstable; urgency=low

  * Make sure all data that is streamed to the client during download
    gets flushed afterwards using cgi#output#commit_work
  * Added debian/control.in and a rule to generate debian/control from it
  * Added conditional dependency on OCaml bytecode interpreter
    for architectures without native compilation

 -- Eric Cooper <ecc@cmu.edu>  Sun, 20 Nov 2005 12:20:58 -0500

approx (2.01) unstable; urgency=low

  * Updated debian/control for ocaml version 3.09.0
  * Added dependency on adduser (for postinst script)
  * Removed unused variables (or renamed with _) to eliminate warnings

 -- Eric Cooper <ecc@cmu.edu>  Tue,  1 Nov 2005 17:43:55 -0500

approx (2.00) unstable; urgency=low

  * Stream the response to the client while downloading to the cache
  * Release with new major version

 -- Eric Cooper <ecc@cmu.edu>  Mon, 10 Oct 2005 10:04:09 -0400

approx (1.51) unstable; urgency=low

  * Changed client to use curl subprocesses instead of ocurl
  * For simplicity, all downloads are cached first, then sent to the client

 -- Eric Cooper <ecc@cmu.edu>  Wed, 14 Sep 2005 09:37:54 -0400

approx (1.50) unstable; urgency=low

  * Changed server to use nethttpd instead of ocaml-http

 -- Eric Cooper <ecc@cmu.edu>  Mon, 22 Aug 2005 16:53:22 -0400

approx (1.18) unstable; urgency=low

  * Secure APT imposes additional consistency requirements on the cache:
    - Release and Release.gpg files must agree
    - Packages and Sources files must agree with the Release file
      that mentions them
  * Closes: #322847

 -- Eric Cooper <ecc@cmu.edu>  Sun, 31 Jul 2005 16:10:13 -0400

approx (1.17) unstable; urgency=low

  * Incorporate patch by Flavio Stanchina <flavio@stanchina.net>
    to recognize Release.gpg and *.bz2 files in gc_approx (closes: #313188)
  * Include Last-Modified header in local responses
  * Support If-Modified-Since for FTP requests using MDTM

 -- Eric Cooper <ecc@cmu.edu>  Fri, 15 Jul 2005 15:34:21 -0400

approx (1.16) unstable; urgency=low

  * Support concurrent requests
    - use http_daemon's Fork mode
    - rely on atomic rename of foo.tmp -> foo in cache
    - detect concurrent downloads in progress and wait for them
  * Differentiate levels of syslog messages

 -- Eric Cooper <ecc@cmu.edu>  Fri, 13 May 2005 12:23:37 -0400

approx (1.15) unstable; urgency=low

  * Build byte-code version on architectures with no ocamlopt
  * Create /var/cache/approx directory in postinst script

 -- Eric Cooper <ecc@cmu.edu>  Sat,  7 May 2005 11:08:38 -0400

approx (1.14) unstable; urgency=low

  * Added --foreground option to approx (closes: #306898)

 -- Eric Cooper <ecc@cmu.edu>  Thu,  5 May 2005 10:43:36 -0400

approx (1.13) unstable; urgency=low

  * Make sure /var/cache/approx exists before trying to chown it
    (closes: #306621)
  * No longer allow the cache directory to be specified in approx.conf;
    always use /var/cache/approx (which can be a symlink)

 -- Eric Cooper <ecc@cmu.edu>  Wed, 27 Apr 2005 18:39:13 -0400

approx (1.12) unstable; urgency=low

  * New description, from suggestions by
    Raphaël Berbain <raphael.berbain@free.fr>
  * approx
    - run as unprivileged user (closes: #305451)
    - added /etc/default/approx with example of setting
      http_proxy environment variable (closes: #305453)
    - detect possible conflict with apt-proxy at installation time
      and at runtime if binding to port 9999 fails
  * gc_approx
    - remove unused distributions and empty parent directories from cache
    - don't recheck files that have already been checked
    - uncompress Packages.gz files to disk
    - use wget to download Packages.gz file if decompression fails

 -- Eric Cooper <ecc@cmu.edu>  Mon, 25 Apr 2005 09:01:56 -0400

approx (1.11) unstable; urgency=low

  * Daemonize correctly (closes: #305102)

 -- Eric Cooper <ecc@cmu.edu>  Sun, 17 Apr 2005 19:57:56 -0400

approx (1.10) unstable; urgency=low

  * Bumped dependency on syslog-ocaml (closes: #305019)

 -- Eric Cooper <ecc@cmu.edu>  Sun, 17 Apr 2005 12:47:12 -0400

approx (1.09) unstable; urgency=low

  * rebuilt against ocamlnet 1.0 and ocaml-http 0.1.0-3
  * debian/control
    - added me as an uploader
    - bumped dependencies on ocamlnet and ocaml-http

 -- Stefano Zacchiroli <zack@debian.org>  Sat, 16 Apr 2005 10:13:30 +0200

approx (1.08) unstable; urgency=low

  * Removed trunk directory layer
  * Add build-dependency on ocaml-tools (closes: #303774)

 -- Eric Cooper <ecc@cmu.edu>  Fri,  8 Apr 2005 14:57:43 -0400

approx (1.07) unstable; urgency=low

  * Eliminate timeout for approx daemon callbacks
  * Make gc_approx handle "Filename: ./foo" correctly
  * Turn on all OCaml compiler warnings and clean up code
  * Sven Luther :
    - Preparing upload built with ocaml 3.08.3.
    - Taking over maintainership of this package, since Eric is not a DD.
    - Tested on my home setup since the past three weeks.

 -- Eric Cooper <ecc@cmu.edu>  Sat, 12 Mar 2005 17:27:43 -0500

approx (1.06) unstable; urgency=low

  * Use native syslog client instead of piping output to logger
  * Use open_process_in and gzip instead of camlzip to uncompress
    package files in gc_approx
  * gc_approx removes garbage files unless --keep option is specified
  * APPROX_CONF environment variable no longer used;
    pathname is now hard-coded in default_config.ml
  * Write /var/run/approx.pid for use by init script

 -- Eric Cooper <ecc@cmu.edu>  Thu, 24 Feb 2005 13:36:26 -0500

approx (1.05) unstable; urgency=low

  * Use proper content type and encoding when relaying *.gz files
  * Log client IP address
  * Install into /usr/sbin
  * Add init.d and cron scripts
  * Double fork to detach daemon
  * Use distribution names from the config file as roots for GC,
    to detect remote repositories no longer in use

 -- Eric Cooper <ecc@cmu.edu>  Wed, 23 Feb 2005 23:59:35 -0500

approx (1.04) unstable; urgency=low

  * Add build-dependency on the version of ocamlnet
    which fixes a problem with '+' characters in URLs
  * Append ".tmp" to download in progress and rename it when complete,
    to avoid invalid files in the cache if the daemon is interrupted

 -- Eric Cooper <ecc@cmu.edu>  Sun,  6 Feb 2005 17:20:18 -0500

approx (1.03) unstable; urgency=low

  * Cleanup libcurl connection after each transfer

 -- Eric Cooper <ecc@cmu.edu>  Fri,  4 Feb 2005 09:05:00 -0500

approx (1.02) unstable; urgency=low

  * Use libcurl-ocaml instead of my own wrapper

 -- Eric Cooper <ecc@cmu.edu>  Thu,  3 Feb 2005 21:42:36 -0500

approx (1.01) unstable; urgency=low

  * Don't garbage collect only .deb files;
    consider everything except Packages, Release, and Sources files

 -- Eric Cooper <ecc@cmu.edu>  Tue,  1 Feb 2005 15:52:02 -0500

approx (1.00) unstable; urgency=low

  * Initial release

 -- Eric Cooper <ecc@cmu.edu>  Sun, 23 Jan 2005 14:05:29 -0500
